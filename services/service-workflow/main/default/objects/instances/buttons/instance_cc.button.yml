name: instance_cc
amis_actions: |-
  [
          {
            "actionType": "dialog",
            "dialog": {
              "type": "dialog",
              "title": {
                "type": "tpl",
                "id": "u:0bce3c33b6e5",
                "tpl": "<p>传阅<a href=\"https://www.steedos.cn/docs/user/workflow#%E5%A6%82%E4%BD%95%E4%BC%A0%E9%98%85\" target=\"_blank\" rel=\"noopener\"> ?&nbsp;</a></p>"
              },
              "body": [
                {
                  "type": "tpl",
                  "tpl": "<p>当前步骤: ${record.step.name}</p>",
                  "inline": false,
                  "id": "u:11bcfab80ce9",
                  "className": "m-b-sm"
                },
                {
                  "type": "select",
                  "label": "传阅对象",
                  "name": "select",
                  "options": [
                    {
                      "label": "选项A",
                      "value": "A"
                    },
                    {
                      "label": "选项B",
                      "value": "B"
                    }
                  ],
                  "id": "u:c3ad733db360",
                  "multiple": false,
                  "mode": "normal",
                  "required": true
                },
                {
                  "type": "textarea",
                  "label": "传阅说明",
                  "name": "cc_description",
                  "id": "u:1dc7e49e6e7d",
                  "minRows": 3,
                  "maxRows": 20
                }
              ],
              "id": "u:519ca64b1934",
              "actions": [
                {
                  "type": "button",
                  "label": "取消",
                  "onEvent": {
                    "click": {
                      "actions": [
                        {
                          "componentId": "",
                          "args": {},
                          "actionType": "closeDialog"
                        }
                      ]
                    }
                  },
                  "id": "u:1d0d136fe2f0"
                },
                {
                  "type": "button",
                  "label": "确定",
                  "onEvent": {
                    "click": {
                      "actions": [
                        {
                          "componentId": "",
                          "args": {
                            "msgType": "info",
                            "position": "top-right",
                            "closeButton": true,
                            "showIcon": true,
                            "msg": "未完成: 待处理",
                            "title": "缺失选人控件"
                          },
                          "actionType": "toast"
                        },
                        {
                          "componentId": "",
                          "args": {},
                          "actionType": "closeDialog"
                        }
                      ]
                    }
                  },
                  "id": "u:f7f767bed23f",
                  "level": "primary"
                }
              ]
            }
          }
        ]
amis_schema: |-
  {
      "type": "service",
      "body": [
          {
              "type": "button",
              "label": "传阅",
              "id": "u:instance_cc",
              "onEvent": {
                  "click": {
                      "actions": [
                          {
                              "actionType": "dialog",
                              "dialog": {
                                  "type": "dialog",
                                  "title": {
                                      "type": "tpl",
                                      "id": "u:0bce3c33b6e5",
                                      "tpl": "<p>传阅<a href=\"https://www.steedos.cn/docs/user/workflow#%E5%A6%82%E4%BD%95%E4%BC%A0%E9%98%85\" target=\"_blank\" rel=\"noopener\"> ?&nbsp;</a></p>"
                                  },
                                  "body": [
                                      {
                                          "type": "tpl",
                                          "tpl": "<p>当前步骤: ${record.step.name}</p>",
                                          "inline": false,
                                          "id": "u:11bcfab80ce9",
                                          "className": "m-b-sm"
                                      },
                                      {
                                          "type": "select",
                                          "label": "传阅对象",
                                          "name": "select",
                                          "options": [
                                              {
                                                  "label": "选项A",
                                                  "value": "A"
                                              },
                                              {
                                                  "label": "选项B",
                                                  "value": "B"
                                              }
                                          ],
                                          "id": "u:c3ad733db360",
                                          "multiple": false,
                                          "mode": "normal",
                                          "required": true
                                      },
                                      {
                                          "type": "textarea",
                                          "label": "传阅说明",
                                          "name": "cc_description",
                                          "id": "u:1dc7e49e6e7d",
                                          "minRows": 3,
                                          "maxRows": 20
                                      }
                                  ],
                                  "id": "u:519ca64b1934",
                                  "actions": [
                                      {
                                          "type": "button",
                                          "label": "取消",
                                          "onEvent": {
                                              "click": {
                                                  "actions": [
                                                      {
                                                          "componentId": "",
                                                          "args": {},
                                                          "actionType": "closeDialog"
                                                      }
                                                  ]
                                              }
                                          },
                                          "id": "u:1d0d136fe2f0"
                                      },
                                      {
                                          "type": "button",
                                          "label": "确定",
                                          "onEvent": {
                                              "click": {
                                                  "actions": [
                                                      {
                                                          "componentId": "",
                                                          "args": {
                                                              "msgType": "info",
                                                              "position": "top-right",
                                                              "closeButton": true,
                                                              "showIcon": true,
                                                              "msg": "未完成: 待处理",
                                                              "title": "缺失选人控件"
                                                          },
                                                          "actionType": "toast"
                                                      },
                                                      {
                                                          "componentId": "",
                                                          "args": {},
                                                          "actionType": "closeDialog"
                                                      }
                                                  ]
                                              }
                                          },
                                          "id": "u:f7f767bed23f",
                                          "level": "primary"
                                      }
                                  ]
                              }
                          }
                      ],
                      "weight": 0
                  }
              },
              "hiddenOn": "!(\n\t(record.box === 'inbox' && record.state === 'pending' && \n  \t\t(_.includes(record.cc_users, context.user.userId) \n         || (record.step?.disableCC != true && record.step?.step_type != 'start')))\n  \t||\n  \t(record.box === 'outbox' && record.state === 'pending' &&\n    \t(record.lastCCStep?.disableCC != true && record.lastCCStep?.step_type != 'start')\n    )\n  \n)"
          }
      ],
      "regions": [
          "body"
      ],
      "data": {
          "context": {
              "rootUrl": "http://127.0.0.1:5000"
          },
          "app_id": "",
          "tab_id": "",
          "object_name": "",
          "dataComponentId": "",
          "record_id": "",
          "record": {},
          "permissions": {}
      },
      "bodyClassName": "p-0",
      "id": "u:7414f3c8128c"
  }
is_enable: true
label: 传阅
'on': record_only
type: amis_button
visible: true
