function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=t("@lezer/common");let i=0;class r{constructor(t,e,a){this.set=t,this.base=e,this.modified=a,this.id=i++}static define(t){if(null==t?void 0:t.base)throw new Error("Can not derive from a modified tag");let e=new r([],null,[]);if(e.set.push(e),t)for(let a of t.set)e.set.push(a);return e}static defineModifier(){let t=new o;return e=>e.modified.indexOf(t)>-1?e:o.get(e.base||e,e.modified.concat(t).sort((t,e)=>t.id-e.id))}}let s=0;class o{constructor(){this.instances=[],this.id=s++}static get(t,e){if(!e.length)return t;let a=e[0].instances.find(a=>a.base==t&&l(e,a.modified));if(a)return a;let i=[],s=new r(i,t,e);for(let r of e)r.instances.push(s);let c=n(e);for(let r of t.set)for(let t of c)i.push(o.get(r,t));return s}}function l(t,e){return t.length==e.length&&t.every((t,a)=>t==e[a])}function n(t){let e=[t];for(let a=0;a<t.length;a++)for(let i of n(t.slice(0,a).concat(t.slice(a+1))))e.push(i);return e}function c(t){let e=Object.create(null);for(let a in t){let i=t[a];Array.isArray(i)||(i=[i]);for(let t of a.split(" "))if(t){let a=[],r=2,s=t;for(let e=0;;){if("..."==s&&e>0&&e+3==t.length){r=1;break}let i=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(s);if(!i)throw new RangeError("Invalid path: "+t);if(a.push("*"==i[0]?"":'"'==i[0][0]?JSON.parse(i[0]):i[0]),(e+=i[0].length)==t.length)break;let o=t[e++];if(e==t.length&&"!"==o){r=0;break}if("/"!=o)throw new RangeError("Invalid path: "+t);s=t.slice(e)}let o=a.length-1,l=a[o];if(!l)throw new RangeError("Invalid path: "+t);let n=new g(i,r,o>0?a.slice(0,o):null);e[l]=n.sort(e[l])}}return h.add(e)}const h=new a.NodeProp;class g{constructor(t,e,a,i){this.tags=t,this.mode=e,this.context=a,this.next=i}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}function f(t,e){let a=Object.create(null);for(let s of t)if(Array.isArray(s.tag))for(let t of s.tag)a[t.id]=s.class;else a[s.tag.id]=s.class;let{scope:i,all:r=null}=e||{};return{style:t=>{let e=r;for(let i of t)for(let t of i.set){let i=a[t.id];if(i){e=e?e+" "+i:i;break}}return e},scope:i}}function d(t,e){let a=null;for(let i of t){let t=i.style(e);t&&(a=a?a+" "+t:t)}return a}function m(t,e,a,i=0,r=t.length){let s=new p(i,Array.isArray(e)?e:[e],a);s.highlightRange(t.cursor(),i,r,"",s.highlighters),s.flush(r)}class p{constructor(t,e,a){this.at=t,this.highlighters=e,this.span=a,this.class=""}startSpan(t,e){e!=this.class&&(this.flush(t),t>this.at&&(this.at=t),this.class=e)}flush(t){t>this.at&&this.class&&this.span(this.at,t,this.class)}highlightRange(t,e,i,r,s){let{type:o,from:l,to:n}=t;if(l>=i||n<=e)return;o.isTop&&(s=this.highlighters.filter(t=>!t.scope||t.scope(o)));let c=r,g=o.prop(h),f=!1;for(;g;){if(!g.context||t.matchContext(g.context)){let t=d(s,g.tags);t&&(c&&(c+=" "),c+=t,1==g.mode?r+=(r?" ":"")+t:0==g.mode&&(f=!0));break}g=g.next}if(this.startSpan(t.from,c),f)return;let m=t.tree&&t.tree.prop(a.NodeProp.mounted);if(m&&m.overlay){let a=t.node.enter(m.overlay[0].from+l,1),o=this.highlighters.filter(t=>!t.scope||t.scope(m.tree.type)),h=t.firstChild();for(let g=0,f=l;;g++){let d=g<m.overlay.length?m.overlay[g]:null,p=d?d.from+l:n,u=Math.max(e,f),k=Math.min(i,p);if(u<k&&h)for(;t.from<k&&(this.highlightRange(t,u,k,r,s),this.startSpan(Math.min(i,t.to),c),!(t.to>=p)&&t.nextSibling()););if(!d||p>i)break;(f=d.to+l)>e&&(this.highlightRange(a.cursor(),Math.max(e,d.from+l),Math.min(i,f),r,o),this.startSpan(f,c))}h&&t.parent()}else if(t.firstChild()){do{if(!(t.to<=e)){if(t.from>=i)break;this.highlightRange(t,e,i,r,s),this.startSpan(Math.min(i,t.to),c)}}while(t.nextSibling());t.parent()}}}const u=r.define,k=u(),b=u(),y=u(b),N=u(b),v=u(),w=u(v),x=u(v),M=u(),O=u(M),S=u(),R=u(),C=u(),A=u(C),E=u(),I={comment:k,lineComment:u(k),blockComment:u(k),docComment:u(k),name:b,variableName:u(b),typeName:y,tagName:u(y),propertyName:N,attributeName:u(N),className:u(b),labelName:u(b),namespace:u(b),macroName:u(b),literal:v,string:w,docString:u(w),character:u(w),attributeValue:u(w),number:x,integer:u(x),float:u(x),bool:u(v),regexp:u(v),escape:u(v),color:u(v),url:u(v),keyword:S,self:u(S),null:u(S),atom:u(S),unit:u(S),modifier:u(S),operatorKeyword:u(S),controlKeyword:u(S),definitionKeyword:u(S),moduleKeyword:u(S),operator:R,derefOperator:u(R),arithmeticOperator:u(R),logicOperator:u(R),bitwiseOperator:u(R),compareOperator:u(R),updateOperator:u(R),definitionOperator:u(R),typeOperator:u(R),controlOperator:u(R),punctuation:C,separator:u(C),bracket:A,angleBracket:u(A),squareBracket:u(A),paren:u(A),brace:u(A),content:M,heading:O,heading1:u(O),heading2:u(O),heading3:u(O),heading4:u(O),heading5:u(O),heading6:u(O),contentSeparator:u(M),list:u(M),quote:u(M),emphasis:u(M),strong:u(M),link:u(M),monospace:u(M),strikethrough:u(M),inserted:u(),deleted:u(),changed:u(),invalid:u(),meta:E,documentMeta:u(E),annotation:u(E),processingInstruction:u(E),definition:r.defineModifier(),constant:r.defineModifier(),function:r.defineModifier(),standard:r.defineModifier(),local:r.defineModifier(),special:r.defineModifier()},K=f([{tag:I.link,class:"tok-link"},{tag:I.heading,class:"tok-heading"},{tag:I.emphasis,class:"tok-emphasis"},{tag:I.strong,class:"tok-strong"},{tag:I.keyword,class:"tok-keyword"},{tag:I.atom,class:"tok-atom"},{tag:I.bool,class:"tok-bool"},{tag:I.url,class:"tok-url"},{tag:I.labelName,class:"tok-labelName"},{tag:I.inserted,class:"tok-inserted"},{tag:I.deleted,class:"tok-deleted"},{tag:I.literal,class:"tok-literal"},{tag:I.string,class:"tok-string"},{tag:I.number,class:"tok-number"},{tag:[I.regexp,I.escape,I.special(I.string)],class:"tok-string2"},{tag:I.variableName,class:"tok-variableName"},{tag:I.local(I.variableName),class:"tok-variableName tok-local"},{tag:I.definition(I.variableName),class:"tok-variableName tok-definition"},{tag:I.special(I.variableName),class:"tok-variableName2"},{tag:I.definition(I.propertyName),class:"tok-propertyName tok-definition"},{tag:I.typeName,class:"tok-typeName"},{tag:I.namespace,class:"tok-namespace"},{tag:I.className,class:"tok-className"},{tag:I.macroName,class:"tok-macroName"},{tag:I.propertyName,class:"tok-propertyName"},{tag:I.operator,class:"tok-operator"},{tag:I.comment,class:"tok-comment"},{tag:I.meta,class:"tok-meta"},{tag:I.invalid,class:"tok-invalid"},{tag:I.punctuation,class:"tok-punctuation"}]);e.Tag=r,e.classHighlighter=K,e.highlightTree=m,e.styleTags=c,e.tagHighlighter=f,e.tags=I}

